import XLSX from 'xlsx';
import path from 'path';
import fs from 'fs';
import { fileURLToPath } from 'url';

const __filename = fileURLToPath(import.meta.url);
const __dirname = path.dirname(__filename);

// Сабақ кестесі үлгісін жасау
const scheduleTemplate = [
  ['ID', 'Күн', 'Уақыт', 'Сынып', 'Пән', 'Кабинет', 'Ауысым', 'Мұғалім'],
  [1, 'Дүйсенбі', '08:00-08:45', '7 А', 'Қазақ тілі', '210', '1', 'Садықова А.Б.'],
  [2, 'Дүйсенбі', '08:55-09:40', '7 А', 'Математика', '215', '1', 'Ахметов Б.С.'],
  [3, 'Дүйсенбі', '09:50-10:35', '7 А', 'Физика', '310', '1', 'Серікова Г.Д.'],
  [4, 'Дүйсенбі', '10:45-11:30', '7 А', 'Тарих', '203', '1', 'Қалиев Н.М.'],
  [5, 'Дүйсенбі', '11:40-12:25', '7 А', 'Ағылшын тілі', '208', '1', 'Мұратова А.Ж.'],
  
  [6, 'Дүйсенбі', '08:00-08:45', '8 А', 'Математика', '215', '1', 'Ахметов Б.С.'],
  [7, 'Дүйсенбі', '08:55-09:40', '8 А', 'Қазақ тілі', '210', '1', 'Садықова А.Б.'],
  [8, 'Дүйсенбі', '09:50-10:35', '8 А', 'Химия', '308', '1', 'Жұмабаева Р.Қ.'],
  [9, 'Дүйсенбі', '10:45-11:30', '8 А', 'География', '207', '1', 'Тілеуов С.М.'],
  [10, 'Дүйсенбі', '11:40-12:25', '8 А', 'Физика', '310', '1', 'Серікова Г.Д.'],
  
  [11, 'Дүйсенбі', '13:00-13:45', '9 А', 'Физика', '310', '2', 'Серікова Г.Д.'],
  [12, 'Дүйсенбі', '13:55-14:40', '9 А', 'Биология', '311', '2', 'Рахманова Д.Е.'],
  [13, 'Дүйсенбі', '14:50-15:35', '9 А', 'Қазақ тілі', '210', '2', 'Садықова А.Б.'],
  [14, 'Дүйсенбі', '15:45-16:30', '9 А', 'Математика', '215', '2', 'Ахметов Б.С.'],
  [15, 'Дүйсенбі', '16:40-17:25', '9 А', 'Тарих', '203', '2', 'Қалиев Н.М.'],
  
  [16, 'Сейсенбі', '08:00-08:45', '7 А', 'Биология', '311', '1', 'Рахманова Д.Е.'],
  [17, 'Сейсенбі', '08:55-09:40', '7 А', 'Химия', '308', '1', 'Жұмабаева Р.Қ.'],
  [18, 'Сейсенбі', '09:50-10:35', '7 А', 'География', '207', '1', 'Тілеуов С.М.'],
  [19, 'Сейсенбі', '10:45-11:30', '7 А', 'Математика', '215', '1', 'Ахметов Б.С.'],
  [20, 'Сейсенбі', '11:40-12:25', '7 А', 'Қазақ әдебиеті', '210', '1', 'Садықова А.Б.'],
  
  [21, 'Сәрсенбі', '08:00-08:45', '7 А', 'Тарих', '203', '1', 'Қалиев Н.М.'],
  [22, 'Сәрсенбі', '08:55-09:40', '7 А', 'Ағылшын тілі', '208', '1', 'Мұратова А.Ж.'],
  [23, 'Сәрсенбі', '09:50-10:35', '7 А', 'Математика', '215', '1', 'Ахметов Б.С.'],
  [24, 'Сәрсенбі', '10:45-11:30', '7 А', 'Информатика', '305', '1', 'Әлібеков Т.С.'],
  [25, 'Сәрсенбі', '11:40-12:25', '7 А', 'Дене шынықтыру', 'спортзал', '1', 'Бекетов Е.Р.']
];

// Excel файлын жасау функциясы
function createExcelFile(data, filename) {
  // Жаңа жұмыс кітабы (workbook) жасау
  const wb = XLSX.utils.book_new();
  
  // Деректер негізінде жұмыс парағын (worksheet) жасау
  const ws = XLSX.utils.aoa_to_sheet(data);
  
  // Жұмыс парағын кітапқа қосу
  XLSX.utils.book_append_sheet(wb, ws, 'Сабақ кестесі');
  
  // Файл жолдарын дайындау
  const templatesDir = path.join(__dirname, '../public/templates');
  
  // Егер қалта жоқ болса, оны жасау
  if (!fs.existsSync(templatesDir)) {
    fs.mkdirSync(templatesDir, { recursive: true });
  }
  
  // Excel файлын жазу
  const filePath = path.join(templatesDir, filename);
  XLSX.writeFile(wb, filePath);
  
  console.log(`"${filePath}" файлы сәтті жасалды`);
}

// Excel файлын жасау
createExcelFile(scheduleTemplate, 'schedule_template.xlsx');

console.log('Сабақ кестесі үлгі файлы сәтті жасалды!'); 